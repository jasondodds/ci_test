<apex:page docType="html-5.0"
           showHeader="false"
           sidebar="false"
           applyBodyTag="false"
           applyHtmlTag="false"
           standardStylesheets="false"
           cache="true"
>
<html>
<head></head>

  <apex:remoteObjects jsNamespace="RemoteObjectModel">
      <apex:remoteObjectModel name="ProjectDefinition__c"
        jsShorthand="ProjectDefinition"
        fields="Id,Name,Description__c,Namespace__c,Package_Name__c,Repo_Name__c,Repo_Url__c"/>
        <apex:remoteObjectModel name="Environment__c"
        jsShorthand="Environment"
        fields="Id,Name,Branch_Name__c,CI_Project_Definition__c,Namespace__c,Packaging__c,Parent_Environment__c,Production__c,Signup_Request_Status__c"/>
        <apex:remoteObjectModel name="Team_Member__c"
        jsShorthand="TeamMember"
        fields="Id,Name,Contact__c,Email__c,First_Name__c,Last_Name__c,Github_Handle__c,Processed__c,Project_Definition__c"/>
        <apex:remoteObjectModel name="Contact"
        fields="Id,Name,FirstName,LastName,Email,GitHub_Handle__c"/>
  </apex:remoteObjects>

<body>
	<p>User getSampleData('TYPE') in the console with the following types (case sensitive):</p>
	<ul>
		<li>ProjectDefinitions</li>
		<li>TeamMembers</li>
		<li>Environments</li>
		<li>Contacts</li>
	</ul>
	<div id="results"></div>
</body>

<script type="text/javascript">
var getSampleData = function(type){
	return services[type].retrieve({ limit:10 });
};
var renderResults = function(title,results){
	returnHtml = '<h2>'+title+'</h2>';
	returnHtml += JSON.stringify(results,null,'\t');
	document.getElementById('results').innerHTML = returnHtml;
	return returnHtml;
};

var services = services || {};
/* PROJECT DEFINITIONS VRO */
services.ProjectDefinitions = {
  retrieve: function(params){
  	params = params ? {} : params;
    var sfdcProjectDefinitions = new RemoteObjectModel.ProjectDefinition();
    sfdcProjectDefinitions.retrieve( 
        params,  //Return all Team Members = empty filter object
        function(err, records) { 
            if (err) {  
                console.log(err);
            } else { 
              var returnArray = [];
              records.forEach(function(record){
                returnArray.push(services.ProjectDefinitions.parse(record));
              })
                console.log(returnArray);
                renderResults('Project Definitions',returnArray);
                return returnArray;
            } 
        } 
    );
  },
  parse: function(record){
  	var teamMember = {
      "id": record.get('Id'),
      "name": record.get('Name'),
      "description": record.get('Description__c'),
      "namespace": record.get('Namespace__c'),
      "packageName": record.get('Package_Name__c'),
      "repoName": record.get('Repo_Name__c'),
      "repoUrl": record.get('Repo_Url__c')
    };
    return teamMember;
  },
  encode: function(projectDefinition){
  	var record = {
      "Id": projectDefinition.id,
      "Name": projectDefinition.name,
      "Description__c": projectDefinition.description,
      "Namespace__c": projectDefinition.namespace,
      "Package_Name__c": projectDefinition.packageName,
      "Repo_Name__c": projectDefinition.repoName,
      "Repo_Url__c": projectDefinition.repoUrl
    };
    return record;
  }
};
/* TEAM MEMBERS VRO */
services.TeamMembers = {
  retrieve: function(params){
  	params = params ? {} : params;
    var sfdcTeamMembers = new RemoteObjectModel.TeamMember();
    sfdcTeamMembers.retrieve( 
        params,  //Return all Team Members = empty filter object
        function(err, records) { 
            if (err) {  
                console.log(err);
            } else { 
              var returnArray = [];
              records.forEach(function(record){
                returnArray.push(services.TeamMembers.parse(record));
              })
                console.log(returnArray);
                renderResults('Team Members',returnArray);
                return returnArray;
            } 
        } 
    );
  },
  parse: function(record){
  	var teamMember = {
      "id": record.get('Id'),
      "name": record.get('Name'),
      "email": record.get('Email'),
      "firstName": record.get('First_Name__c'),
      "lastName": record.get('Last_Name__c'),
      "githubHandle": record.get('Github_Handle__c'),
      "isProcessed": record.get('Processed__c'),
      "contact": record.get('Contact__c'),
      "projectDefinition": record.get('Project_Definition__c')
    };
    return teamMember;
  },
  encode: function(teamMember){
  	var record = {
      "Id": teamMember.id,
      "Name": teamMember.name,
      "Email": teamMember.email,
      "First_Name__c": teamMember.firstName,
      "Last_Name__c": teamMember.lastName,
      "Github_Handle__c": teamMember.githubHandle,
      "Processed__c": teamMember.isProcessed,
      "Contact__c": teamMember.contact,
      "Project_Definition__c": teamMember.projectDefinition
    };
    return record;
  }
};
/* ENVIRONMENTS VRO */
services.Environments = {
	retrieve: function(params){
  	params = params ? {} : params;
    var sfdcEnvironments = new RemoteObjectModel.Environment();
    sfdcEnvironments.retrieve( 
        params,  //Return all Team Members = empty filter object
        function(err, records) { 
            if (err) {  
                console.log(err);
            } else { 
              var returnArray = [];
              records.forEach(function(record){
                returnArray.push(services.Environments.parse(record));
              })
                console.log(returnArray);
                renderResults('Environments',returnArray);
                return returnArray;
            } 
        } 
    );
  },
  parse: function(record){
  	var environment = {
      "id": record.get('Id'),
      "name": record.get('Name'),
      "branchName": record.get('Branch_Name__c'),
      "projectDefinition": record.get('CI_Project_Definition__c'),
      "namespace": record.get('Namespace__c'),
      "isPackaging": record.get('Packaging__c'),
      "parentEnvironment": record.get('Parent_Environment__c'),
      "isProduction": record.get('Production__c'),
      "signupRequestStatus": record.get('Signup_Request_Status__c')
    };
    return environment;
  },
  encode: function(environment){
  	var record = {
      "Id": record.get('id'),
      "Name": record.get('name'),
      "Branch_Name__c": environment.branchName,
      "CI_Project_Definition__c": environment.projectDefinition,
      "Namespace__c": environment.namespace,
      "Packaging__c": environment.isPackaging,
      "Parent_Environment__c": environment.paentEnvironment,
      "Production__c": environment.isProduction,
      "Signup_Request_Status__c": environment.signupRequestStatus
    };
    return record;
  }
};
/* CONTACTS VRO */
services.Contacts = {
	retrieve: function(params){
  	params = params ? {} : params;
    var sfdcContacts = new RemoteObjectModel.Contact();
    sfdcContacts.retrieve( 
        params,  //Return all Team Members = empty filter object
        function(err, records) { 
            if (err) {  
                console.log(err);
            } else { 
              var returnArray = [];
              records.forEach(function(record){
                returnArray.push(services.Contacts.parse(record));
              })
                console.log(returnArray);
                renderResults('Contacts',returnArray);
                return returnArray;
            } 
        } 
    );
  },
  parse: function(record){
  	var contact = {
      "id": record.get('Id'),
      "name": record.get('Name'),
      "firstName": record.get('FirstName'),
      "lastName": record.get('LastName'),
      "email": record.get('Email'),
      "githubHandle": record.get('GitHub_Handle__c')
    };
    return contact;
  },
  encode: function(contact){
  	var record = {
      "Id": contact.id,
      "Name": contact.name,
      "FirstName": contact.firstName,
      "LastName": contact.lastName,
      "Email": contact.email,
      "GitHub_Handle__c": contact.githubHandle
    };
    return record;
  }
};


</script>
</html>
</apex:page>